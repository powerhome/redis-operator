# Development

## Folder structure

### Code folder structure

- **api**: definition of the RedisFailover CRD.
- **client**: autogenerated client to interact with redis-failovers.
- **cmd**: contains the starting point of the application.
- **log**: wrapper of logrus, created to be able to mock it.
- **metrics**: exposer of status of the failovers created.
- **mocks**: contains the mocked interfaces for testing the application.
- **operator**: the main logic. Manages the requests from k8s and creates/updates/deletes the pieces as needed.
- **service**: services/clients to interact with k8s and redises.
- **vendor**: vendored packages used by the application.

### Non-code folder structure

- **charts**: helm chart to deploy the operator.
- **docker**: Dockerfiles to generate redis-failover docker images.
- **example**: yaml files with spec of redis-failover.
- **hack**: scripts to generate the redis-failover api-client.
- **scripts**: scripts used to build and run the app.

## Make development commands

You can do the following commands with make:

- Generate kubernetes client
  `make generate-client`
- Generate kubernetes Custom Resource Definitions
  `make generate-crd`
- Generate go code.
  `make generate-mocks`
- Generate mocks.
  `make generate-mocks`
- Run all code generators
  `make generate`
- Build the development environment docker image.
  `make image-dev-tools`
- Build the operator image for local, end-to-end testing purposes
  `make image-local`
- Connect to a BASH shell the development environment docker image
  `make shell`
- Run unit tests in the development docker container
  `make test-unit`
- Run helm tests in the development docker container
  `make test-heml`
- Run all development tests
  `make test`
